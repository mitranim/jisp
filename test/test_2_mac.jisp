[use `jisp:prelude` `*`]

; "global" must be predefined.
[const g global]

; FIXME implement.
; FIXME exclude from compiled code, unless used by non-macros.
[fn astMacro []
  ; Shadowing must work.
  [const g global]
  [g.console.log `executing AST macro`]

  ; FIXME implement.
  ; FIXME compile error for unknown identifier "one" and others.
  ; [quote [one two three]]
]

[callSyntax `list macro call ast` astMacro]

; Compile error.
astMacro

; Compile error.
[astMacro 10 20 30]

[fn valMacro []
  ; Shadowing must work.
  [const g global]
  [g.console.log `executing val macro`]

  [g.Array.of
    10
    [g.Object.fromEntries
      [g.Array.of
        [g.Array.of `one` 20]
        [g.Array.of `ðŸ™‚ðŸ˜›ðŸ˜ž` 30]
      ]
    ]
  ]
]

; TODO consider: get "Def" and call its method.
[callSyntax `list macro call val` valMacro]

; Compile error.
valMacro

; Compile error.
[valMacro 10 20 30]
